# Worship Flow

Real-time worship band management en live directing tool voor kerken. Gebouwd voor gebruik op een lokaal netwerk.

## Tech Stack

- **Backend:** Node.js + Express.js + WebSocket (ws)
- **Frontend:** Vanilla HTML/CSS/JavaScript (geen frameworks)
- **Database:** JSON file-based (`data.json`)
- **Taal interface:** Nederlands

## Project Structuur

```
worship-flow/
├── server.js           # Express + WebSocket server
├── data.json           # JSON database (persistent storage)
├── package.json        # Dependencies
├── public/
│   ├── index.html      # Home/landing page
│   ├── dirigent.html   # Conductor console (desktop)
│   └── zanger.html     # Singer interface (mobile-friendly)
```

## Ontwikkeling

```bash
# Installeren
npm install

# Starten
npm start
```

**URLs:**
- Home: http://localhost:3000
- Dirigent: http://localhost:3000/dirigent
- Zanger: http://localhost:3000/zanger

## API Endpoints

### Songs
- `GET /api/songs` - Alle nummers ophalen
- `GET /api/songs/:id` - Nummer met geschiedenis
- `POST /api/songs` - Nummer aanmaken
- `PUT /api/songs/:id` - Nummer bijwerken
- `DELETE /api/songs/:id` - Nummer verwijderen

### Setlists
- `GET /api/setlists` - Alle setlists
- `GET /api/setlists/:id` - Setlist met nummers
- `POST /api/setlists` - Setlist aanmaken
- `PUT /api/setlists/:id` - Setlist bijwerken
- `DELETE /api/setlists/:id` - Setlist verwijderen

### Setlist Songs
- `POST /api/setlists/:id/songs` - Nummer toevoegen
- `PUT /api/setlists/:id/songs/reorder` - Volgorde wijzigen
- `DELETE /api/setlists/:setlistId/songs/:songId` - Nummer verwijderen

### Feedback
- `POST /api/songs/:id/feedback` - Feedback loggen

### Categories
- `GET /api/categories` - Categorieën en stijlen ophalen

## Data Model

```javascript
// data.json structuur
{
  songs: [{ id, title, lyrics, key, tempo, category, style, karaoke_link, structure }],
  setlists: [{ id, name, date, notes, status, songs: [{songId, position}] }],
  categories: [{ id, name, type: 'category'|'style' }],
  songHistory: [{ id, songId, setlistId, playedDate, key_used, tempo_feedback, key_feedback, notes }]
}
```

## WebSocket Messages

Real-time synchronisatie tussen dirigent en zangers:

- `setState` - Broadcast setlist/song changes
- `navigate` - Sync song en sectie positie
- `cue` - Stuur live cues naar zangers (1-2-3!, PAUZE, BIS, etc.)

## Tekst Formatting

- **Accenten:** `**tekst**` voor nadruk (bold + goud)
- **Secties:** `---` als scheidingslijn

## Keyboard Shortcuts (Dirigent - Live Mode)

| Toets | Actie |
|-------|-------|
| `←/→` | Navigeer secties |
| `Space` | PAUZE cue |
| `1` | 1-2-3! count-in |
| `N` | Volgend nummer |
| `P` | Vorig nummer |

## Design System

**Kleuren:**
- Background: `#0a0a0f`
- Accent Gold: `#d4a853`
- Text Primary: `#f5f5f0`
- Connected: `#4ade80`
- Disconnected: `#f87171`

**Fonts:**
- Headers: Playfair Display (serif)
- Body: Source Sans 3 (sans-serif)
- Code: JetBrains Mono

## Belangrijke Conventies

- Server draait op poort 3000 (of `PORT` env var)
- Luistert op `0.0.0.0` voor netwerk toegang
- Auto-reconnect WebSocket na 3 seconden bij disconnect
- Data wordt automatisch opgeslagen na elke wijziging

## Development Principes

### Oplossingen
- **Stel direct professionele oplossingen voor** - geen iteratieve "simpele eerst" aanpak
- Bij algoritmes: denk na over schaalbaarheid, edge cases, en bestaande best practices
- Voorbeeld: gebruik proportionele/adaptieve algoritmes i.p.v. hardcoded waarden waar mogelijk

### UX & Berichten
- Houd user-facing teksten kort en actionable
- Combineer status + actie in één message (bijv. "Clip -3dB" niet "Clipping gedetecteerd, gain wordt verlaagd...")
- Geen technische percentages/waarden tonen tenzij relevant voor de gebruiker

### Code Kwaliteit
- Controleer bestaande code patronen voor je nieuwe code schrijft
- Hergebruik bestaande utilities en services
- Comments alleen waar de logica niet vanzelfsprekend is